# 游戏爬虫系统使用指南

## 📋 系统概述

这个游戏爬虫系统可以自动从全网搜索和收集在线游戏资源，支持iframe嵌入式游戏和HTML静态游戏两种类型，并自动添加到你的AnyGame项目中。

## 🚀 快速开始

### Windows用户
1. 双击运行 `scripts/run_crawler.bat`
2. 选择运行模式（推荐选择"快速爬取"）
3. 等待爬取完成

### Linux/Mac用户
1. 在终端中运行：
   ```bash
   cd scripts
   ./run_crawler.sh
   ```
2. 选择运行模式
3. 等待爬取完成

## 📁 文件结构

```
scripts/
├── game_crawler.py          # 完整版爬虫脚本
├── quick_crawl.py           # 快速版爬虫脚本
├── requirements.txt         # Python依赖包
├── run_crawler.bat          # Windows运行脚本
├── run_crawler.sh           # Linux/Mac运行脚本
├── README.md               # 英文说明文档
└── 游戏爬虫使用指南.md      # 中文使用指南（本文件）
```

## 🔧 手动安装和运行

如果自动脚本无法运行，可以手动执行以下步骤：

### 1. 安装Python依赖
```bash
cd scripts
pip install -r requirements.txt
```

### 2. 运行爬虫
```bash
# 快速爬取（推荐）
python quick_crawl.py

# 完整爬取
python game_crawler.py
```

## ⚙️ 配置选项

### 修改爬取数量
在脚本文件中修改以下参数：

**quick_crawl.py**：
```python
for item in soup.select('.game_cell')[:5]:  # 修改数字5为其他值
```

**game_crawler.py**：
```python
crawler.run(max_games=30)  # 修改数字30为其他值
```

### 添加新的游戏平台
在脚本中的`SEED_URLS`列表中添加新的URL：

```python
SEED_URLS = [
    'https://itch.io/games/html5',
    'https://gamejolt.com/games/best',
    'https://your-new-platform.com/games',  # 添加新平台
]
```

### 修改搜索关键词
在`SEARCH_QUERIES`列表中添加或修改搜索关键词：

```python
SEARCH_QUERIES = [
    'site:itch.io browser games',
    'HTML5游戏',
    '你的新关键词',  # 添加新关键词
]
```

## 📊 输出结果

爬虫运行完成后，会在以下位置生成文件：

1. **src/data/games.ts** - 更新的游戏数据文件
2. **public/games/thumbnails/** - 下载的游戏缩略图
3. **game_crawler.log** - 详细的运行日志

## 🎮 支持的游戏类型

### iframe游戏
- 通过iframe嵌入的在线游戏
- 直接在网站上运行
- 无需下载游戏文件

### 静态HTML游戏
- 可下载的HTML5游戏文件
- 包含完整的游戏资源
- 可以离线运行

## 🌐 支持的游戏平台

- **itch.io** - 独立游戏平台
- **GameJolt** - 游戏社区平台
- **Newgrounds** - 创意内容平台
- **Kongregate** - 浏览器游戏平台
- **ArmorGames** - 在线游戏网站
- **Poki** - 免费在线游戏
- **CrazyGames** - HTML5游戏平台
- **Miniclip** - 经典游戏网站
- **AddictingGames** - 休闲游戏平台
- **Y8** - 多语言游戏平台

## 🏷️ 自动分类系统

爬虫会自动将英文分类映射为中文：

| 英文分类 | 中文分类 |
|---------|---------|
| puzzle | 益智 |
| action | 动作 |
| adventure | 冒险 |
| arcade | 休闲 |
| casual | 休闲 |
| strategy | 策略 |
| sports | 体育 |
| racing | 竞速 |
| shooter | 射击 |
| rpg | 角色扮演 |
| simulation | 模拟 |
| card | 卡牌 |
| board | 棋盘 |

## 🔍 搜索策略

### 种子URL爬取
- 直接访问知名游戏平台
- 解析游戏列表页面
- 提取游戏基本信息

### 搜索引擎搜索
- 使用DuckDuckGo搜索
- 支持中英文关键词
- 自动过滤无效结果

### 智能去重
- 基于游戏标题去重
- 避免重复添加相同游戏
- 保持数据库整洁

## 📝 日志系统

爬虫运行时会生成详细的日志文件`game_crawler.log`，包含：

- 爬取进度信息
- 成功/失败的URL
- 错误详情和堆栈跟踪
- 处理的游戏数量统计

## ⚠️ 注意事项

### 网络限制
- 某些网站可能有反爬虫机制
- 建议在网络状况良好时运行
- 如遇到频繁失败，可以稍后重试

### 数据质量
- 自动提取的数据可能需要人工审核
- 建议定期检查新添加的游戏
- 可以手动编辑`src/data/games.ts`文件

### 法律合规
- 请遵守各网站的使用条款
- 仅用于个人学习和研究目的
- 不要过度频繁地访问目标网站

## 🛠️ 故障排除

### 常见问题

**1. Python环境问题**
```bash
# 检查Python版本
python --version

# 如果版本低于3.7，请升级Python
```

**2. 依赖包安装失败**
```bash
# 使用国内镜像源
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

**3. 网络连接超时**
- 检查网络连接
- 尝试使用VPN
- 增加超时时间（修改脚本中的timeout参数）

**4. 权限错误**
- 确保对项目目录有写入权限
- 在Windows上以管理员身份运行
- 在Linux/Mac上检查文件权限

### 调试模式

如需查看详细的调试信息，可以修改日志级别：

```python
# 在脚本开头修改
logging.basicConfig(
    level=logging.DEBUG,  # 改为DEBUG级别
    # ...
)
```

## 🔄 定期更新

建议定期运行爬虫以获取最新的游戏资源：

- **每周运行一次**：获取新发布的游戏
- **每月完整爬取**：全面更新游戏库
- **按需运行**：当需要特定类型游戏时

## 📞 技术支持

如果遇到问题，可以：

1. 查看`game_crawler.log`日志文件
2. 检查网络连接和Python环境
3. 参考本文档的故障排除部分
4. 在项目仓库中提交Issue

## 🎯 最佳实践

1. **首次使用**：建议先运行快速爬取模式
2. **定期维护**：定期清理无效的游戏链接
3. **备份数据**：在运行爬虫前备份现有的games.ts文件
4. **监控日志**：关注日志中的错误信息
5. **合理频率**：避免过于频繁地运行爬虫

---

**祝你使用愉快！如有问题，请参考故障排除部分或查看详细日志。** 